
CREATE VIEW scumbags_v AS /* ALGORITHM=UNDEFINED */ select `s1`.`zip` AS `zip`,`s1`.`full_name` AS `full_name`,`s1`.`first_name` AS `first_name`,`s1`.`last_name` AS `last_name`,`s1`.`address_1` AS `address_1`,`s1`.`address_2` AS `address_2`,`s1`.`city` AS `city`,`s1`.`state` AS `state`,`s1`.`tn` AS `tn`,`s1`.`lat` AS `lat`,`s1`.`long` AS `long`,`s1`.`image_url` AS `image_url`,`s1`.`date_updated` AS `date_updated`,_latin1'SAME' AS `data_status` from `sandbox`.`scumbags` `s1` join `sandbox`.`scumbags` `s2` where ((`s1`.`zip` = `s2`.`zip`) and (`s1`.`full_name` = `s2`.`full_name`) and ((select max(`sandbox`.`scumbags`.`date_updated`) AS `max(date_updated)` from `sandbox`.`scumbags` where ((`sandbox`.`scumbags`.`zip` = `s2`.`zip`) and (`sandbox`.`scumbags`.`date_updated` <> `s1`.`date_updated`))) = `s2`.`date_updated`) and (`s1`.`date_updated` = (select max(`sandbox`.`scumbags`.`date_updated`) AS `max(date_updated)` from `sandbox`.`scumbags` where (`sandbox`.`scumbags`.`zip` = `s1`.`zip`)))) union select `s1`.`zip` AS `zip`,`s1`.`full_name` AS `full_name`,`s1`.`first_name` AS `first_name`,`s1`.`last_name` AS `last_name`,`s1`.`address_1` AS `address_1`,`s1`.`address_2` AS `address_2`,`s1`.`city` AS `city`,`s1`.`state` AS `state`,`s1`.`tn` AS `tn`,`s1`.`lat` AS `lat`,`s1`.`long` AS `long`,`s1`.`image_url` AS `image_url`,`s1`.`date_updated` AS `date_updated`,_latin1'NEW' AS `data_status` from (`sandbox`.`scumbags` `s1` left join `sandbox`.`scumbags` `s2` on(((`s1`.`zip` = `s2`.`zip`) and (`s1`.`full_name` = `s2`.`full_name`) and ((select max(`sandbox`.`scumbags`.`date_updated`) AS `max(date_updated)` from `sandbox`.`scumbags` where ((`sandbox`.`scumbags`.`zip` = `s2`.`zip`) and (`sandbox`.`scumbags`.`date_updated` <> `s1`.`date_updated`))) = `s2`.`date_updated`)))) where ((`s1`.`date_updated` = (select max(`sandbox`.`scumbags`.`date_updated`) AS `max(date_updated)` from `sandbox`.`scumbags` where (`sandbox`.`scumbags`.`zip` = `s1`.`zip`))) and isnull(`s2`.`zip`)) union select `s1`.`zip` AS `zip`,`s1`.`full_name` AS `full_name`,`s1`.`first_name` AS `first_name`,`s1`.`last_name` AS `last_name`,`s1`.`address_1` AS `address_1`,`s1`.`address_2` AS `address_2`,`s1`.`city` AS `city`,`s1`.`state` AS `state`,`s1`.`tn` AS `tn`,`s1`.`lat` AS `lat`,`s1`.`long` AS `long`,`s1`.`image_url` AS `image_url`,`s1`.`date_updated` AS `date_updated`,_latin1'OLD' AS `data_status` from (`sandbox`.`scumbags` `s1` left join `sandbox`.`scumbags` `s2` on(((`s1`.`zip` = `s2`.`zip`) and (`s1`.`full_name` = `s2`.`full_name`) and ((select max(`sandbox`.`scumbags`.`date_updated`) AS `max(date_updated)` from `sandbox`.`scumbags` where (`sandbox`.`scumbags`.`zip` = `s1`.`zip`)) = `s2`.`date_updated`)))) where ((`s1`.`date_updated` = (select max(`sandbox`.`scumbags`.`date_updated`) AS `max(date_updated)` from `sandbox`.`scumbags` where ((`sandbox`.`scumbags`.`zip` = `s1`.`zip`) and (`sandbox`.`scumbags`.`date_updated` <> (select max(`sandbox`.`scumbags`.`date_updated`) AS `max(date_updated)` from `sandbox`.`scumbags` where (`sandbox`.`scumbags`.`zip` = `s1`.`zip`)))))) and isnull(`s2`.`zip`))
;
